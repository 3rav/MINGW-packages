# Maintainer (MSYS2): Jonathan Armstrong <jda2158@gmail.com>

pkgname=rkdeveloptool
pkgver=r70.21b25fd
pkgrel=1
_commit='21b25fd4a70331819b557fe93015b635b9594543'
pkgdesc="rkdeveloptool is a tool from Rockchip to communicate with Rockusb devices"
arch=('any')
url="http://opensource.rock-chips.com/wiki_Rkdeveloptool"
license=('gpl2.0')

makedepends=("${MINGW_PACKAGE_PREFIX}-gcc"
             "${MINGW_PACKAGE_PREFIX}-pkg-config"
             autoconf-wrapper
             automake-wrapper
             git
             make)
depends=(${MINGW_PACKAGE_PREFIX}-'libusb')

source=("rkdeveloptool"::"git+https://github.com/rockchip-linux/rkdeveloptool.git#commit=$_commit")
sha256sums=('SKIP')
install=driver-instructions.install

pkgver() {
    cd "$srcdir/rkdeveloptool"
    printf 'r%s.%s' "$(git rev-list --count HEAD)" "$(git rev-parse --short HEAD)"
}

build() {
  cd "$srcdir/rkdeveloptool"
  
  aclocal
  autoreconf -i
  autoheader
  automake --add-missing
  ./configure
  
  # note: cmakelists included in src appears to be for mac os only
  make
}


package() {
  cd "$srcdir/rkdeveloptool"
  cp rkdeveloptool.exe /usr/bin/
}
