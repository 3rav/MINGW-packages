diff -urN PaStiX4CalculiX-2.17_cudaless.orig/CMakeLists.txt PaStiX4CalculiX-2.17_cudaless/CMakeLists.txt
--- PaStiX4CalculiX-2.17_cudaless.orig/CMakeLists.txt	2021-01-10 11:58:33.000000000 +0100
+++ PaStiX4CalculiX-2.17_cudaless/CMakeLists.txt	2021-02-15 09:27:56.181295000 +0100
@@ -297,7 +297,7 @@
 #---------------------------------
 if (PASTIX_WITH_STARPU)
 
-  set(PASTIX_STARPU_VERSION "1.2" CACHE STRING "oldest STARPU version desired")
+  set(PASTIX_STARPU_VERSION "1.3" CACHE STRING "oldest STARPU version desired")
 
   # Create list of components in order to make a single call to find_package(starpu...)
   set(STARPU_COMPONENT_LIST "HWLOC")
diff -urN PaStiX4CalculiX-2.17_cudaless.orig/blend/simu.c PaStiX4CalculiX-2.17_cudaless/blend/simu.c
--- PaStiX4CalculiX-2.17_cudaless.orig/blend/simu.c	2021-01-10 11:58:33.000000000 +0100
+++ PaStiX4CalculiX-2.17_cudaless/blend/simu.c	2021-02-15 09:27:56.197296000 +0100
@@ -156,7 +156,7 @@
             timerSet(&(simuctrl->ftgttab[i].timerecv), 0.0);
             simuctrl->ftgttab[i].costsend = 0.0;
             simuctrl->ftgttab[i].costadd  = 0.0;
-            memset( simuctrl->ftgttab[i].ftgt.infotab, 0, FTGT_MAXINFO * sizeof(pastix_int_t) );
+            memset(simuctrl->ftgttab[i].ftgt.infotab, '\0', FTGT_MAXINFO*sizeof(pastix_int_t) );
             simuctrl->ftgttab[i].ftgt.infotab[FTGT_FCOLNUM] = PASTIX_INT_MAX;
             simuctrl->ftgttab[i].ftgt.infotab[FTGT_FROWNUM] = PASTIX_INT_MAX;
             simuctrl->ftgttab[i].ftgt.infotab[FTGT_CTRBNBR] = 0;
diff -urN PaStiX4CalculiX-2.17_cudaless.orig/common/api.c PaStiX4CalculiX-2.17_cudaless/common/api.c
--- PaStiX4CalculiX-2.17_cudaless.orig/common/api.c	2021-01-10 11:58:33.000000000 +0100
+++ PaStiX4CalculiX-2.17_cudaless/common/api.c	2021-02-15 09:27:56.214296900 +0100
@@ -55,7 +55,7 @@
         mode_t old_mask = umask(S_IWGRP | S_IWOTH);
 
         *dirtemp = strdup( "pastix-XXXXXX" );
-        *dirtemp = mkdtemp( *dirtemp );
+        *dirtemp = mkstemp( *dirtemp );
         (void)umask(old_mask);
 
         if ( *dirtemp == NULL ) {
diff -urN PaStiX4CalculiX-2.17_cudaless.orig/common/integer.c PaStiX4CalculiX-2.17_cudaless/common/integer.c
--- PaStiX4CalculiX-2.17_cudaless.orig/common/integer.c	2021-01-10 11:58:33.000000000 +0100
+++ PaStiX4CalculiX-2.17_cudaless/common/integer.c	2021-02-15 09:27:56.228297700 +0100
@@ -85,7 +85,7 @@
 }
 
 static inline pastix_int_t intRandVal(pastix_int_t ival) {
-    return (pastix_int_t) (((pastix_uint_t) random ()) % ((pastix_uint_t) (ival)));
+    return (pastix_int_t) (((pastix_uint_t) rand ()) % ((pastix_uint_t) (ival)));
 }
 
 /********************************/
@@ -237,7 +237,7 @@
 #ifdef COMMON_RANDOM_RAND
         srand (intrandseed);
 #else /* COMMON_RANDOM_RAND */
-        srandom (intrandseed);
+        srand (intrandseed);
 #endif /* COMMON_RANDOM_RAND */
         intrandflag = 1;                              /* Generator has been initialized */
     }
@@ -257,7 +257,7 @@
 #ifdef COMMON_RANDOM_RAND
         srand (intrandseed);
 #else /* COMMON_RANDOM_RAND */
-        srandom (intrandseed);
+        srand (intrandseed);
 #endif /* COMMON_RANDOM_RAND */
     }
     else
diff -urN PaStiX4CalculiX-2.17_cudaless.orig/common/models.c PaStiX4CalculiX-2.17_cudaless/common/models.c
--- PaStiX4CalculiX-2.17_cudaless.orig/common/models.c	2021-01-10 11:58:33.000000000 +0100
+++ PaStiX4CalculiX-2.17_cudaless/common/models.c	2021-02-15 09:27:56.250299000 +0100
@@ -15,6 +15,14 @@
 #include "common.h"
 #include "models.h"
 
+#ifdef _WIN32
+
+ssize_t getline(char **lineptr, size_t *n, FILE *stream) {
+    //resto do código aqui
+}
+
+#endif
+
 /**
  *******************************************************************************
  *
diff -urN PaStiX4CalculiX-2.17_cudaless.orig/kernels/CMakeLists.txt PaStiX4CalculiX-2.17_cudaless/kernels/CMakeLists.txt
--- PaStiX4CalculiX-2.17_cudaless.orig/kernels/CMakeLists.txt	2021-01-10 11:58:33.000000000 +0100
+++ PaStiX4CalculiX-2.17_cudaless/kernels/CMakeLists.txt	2021-02-15 09:22:31.383717700 +0100
@@ -92,7 +92,7 @@
   ${generated_sources}
   lowrank.c
   kernels_trace.c
-)
+  )
 
 if(PASTIX_WITH_CUDA)
    set( CUDA_SOURCES
@@ -124,6 +124,10 @@
   PROPERTIES DEPENDS kernels_headers_tgt
   )
 
+add_dependencies(pastix_kernels
+  kernels_headers_tgt
+)
+
 if(PASTIX_WITH_EZTRACE)
    target_link_libraries(pastix_kernels
      ${EZTRACE_LIBRARIES}
diff -urN PaStiX4CalculiX-2.17_cudaless.orig/kernels/kernels_trace.h PaStiX4CalculiX-2.17_cudaless/kernels/kernels_trace.h
--- PaStiX4CalculiX-2.17_cudaless.orig/kernels/kernels_trace.h	2021-01-10 11:58:33.000000000 +0100
+++ PaStiX4CalculiX-2.17_cudaless/kernels/kernels_trace.h	2021-02-15 09:27:56.264299800 +0100
@@ -154,7 +154,7 @@
 
 static inline void kernel_trace_start_lvl0     ( pastix_ktype0_t ktype )  { (void)ktype; }
 static inline void kernel_trace_stop_lvl0      ( double flops )           { (void)flops; }
-static inline void kernel_trace_start_lvl2     ( pastix_ktype2_t ktype )  { (void)ktype; (void)index; }
+static inline void kernel_trace_start_lvl2     ( pastix_ktype2_t ktype )  { (void)ktype; }
 static inline void kernel_trace_stop_lvl2      ( double flops )           { (void)flops; }
 static inline void kernel_trace_stop_lvl2_rank ( double flops, int rank ) { (void)flops; (void)rank; }
 
diff -urN PaStiX4CalculiX-2.17_cudaless.orig/order/order_find_supernodes.c PaStiX4CalculiX-2.17_cudaless/order/order_find_supernodes.c
--- PaStiX4CalculiX-2.17_cudaless.orig/order/order_find_supernodes.c	2021-01-10 11:58:33.000000000 +0100
+++ PaStiX4CalculiX-2.17_cudaless/order/order_find_supernodes.c	2021-02-15 09:27:56.279300600 +0100
@@ -56,7 +56,7 @@
     /* TODO pas la peine d'utiliser un tas; il suffit de parcourir iperm pour assurer
      de toujours traiter un fils avant son pere */
 
-    memset( T, 0, sizeof(pastix_int_t) * n );
+    memset(T, '\0', sizeof(pastix_int_t)*n);
 
     for(k=0;k<n;k++)
     {
@@ -168,27 +168,24 @@
         assert(perm[i] <  n);
     }
 
-    memset( invp, 0, sizeof(pastix_int_t) * n );
-    for(i=0;i<n;i++) {
+    memset(invp, '\0', sizeof(pastix_int_t)*n);
+    for(i=0;i<n;i++)
         invp[perm[i]]++;
-    }
 
     k = 0;
-    for(i=0;i<n;i++) {
-        if(invp[i] != 1) { k++; }
-    }
-    if ( k > 0 ) {
+    for(i=0;i<n;i++)
+        if(invp[i] != 1)
+            k++;
+    if(k>0)
         errorPrint("Number of errors in perm vector in postorder %ld", (long)k);
-    }
     assert(k==0);
 #endif
 
     /*
      * Compute the invp vector
      */
-    for(i=0; i<n; i++) {
+    for(i=0; i<n; i++)
         invp[perm[i]] = i;
-    }
 }
 
 /**
@@ -248,7 +245,7 @@
         jrev[i] = -1;
 
     MALLOC_INTERN(jf, n, pastix_int_t);
-    memset( jf, 0, sizeof(pastix_int_t) * n );
+    memset(jf, '\0', sizeof(pastix_int_t)*n);
 
     for(i=0;i<n;i++)
         father[i] = -1;
@@ -397,7 +394,7 @@
         assert(invp[i] < n);
     }
 
-    memset( S, 0 sizeof(pastix_int_t) * n );
+    memset(S, '\0', sizeof(pastix_int_t)*n);
     for(i=0;i<n;i++)
         S[perm[i]]++;
 
@@ -433,8 +430,8 @@
 
     MALLOC_INTERN(isleaf,     n, pastix_int_t);
     MALLOC_INTERN(prev_rownz, n, pastix_int_t);
-    memset(isleaf,     0, sizeof(pastix_int_t) * n );
-    memset(prev_rownz, 0, sizeof(pastix_int_t) * n );
+    memset(isleaf, '\0', sizeof(pastix_int_t)*n);
+    memset(prev_rownz, '\0', sizeof(pastix_int_t)*n);
 
     for(j=0;j<n;j++)
     {
@@ -459,7 +456,7 @@
      * Compute the number of sons of each node in the elimination tree
      * The snodetab/rangtab is computed in the workspace T.
      */
-    memset( S, 0, sizeof(pastix_int_t) * n );
+    memset(S, '\0', sizeof(pastix_int_t)*n);
     for(i=0;i<n;i++) {
         if(father[i] != i) {
             S[father[i]]++;
diff -urN PaStiX4CalculiX-2.17_cudaless.orig/sopalin/starpu/starpu_sparse_matrix.c PaStiX4CalculiX-2.17_cudaless/sopalin/starpu/starpu_sparse_matrix.c
--- PaStiX4CalculiX-2.17_cudaless.orig/sopalin/starpu/starpu_sparse_matrix.c	2021-01-10 11:58:33.000000000 +0100
+++ PaStiX4CalculiX-2.17_cudaless/sopalin/starpu/starpu_sparse_matrix.c	2021-02-15 09:27:56.295301600 +0100
@@ -39,6 +39,7 @@
     vector_child->id = vector_father->id;
     vector_child->nx = chunk_size;
     vector_child->elemsize = elemsize;
+    vector_child->allocsize = vector_child->nx * elemsize;
 
     if (vector_father->dev_handle)
     {
diff -urN PaStiX4CalculiX-2.17_cudaless.orig/spm/src/drivers/laplacian.c PaStiX4CalculiX-2.17_cudaless/spm/src/drivers/laplacian.c
--- PaStiX4CalculiX-2.17_cudaless.orig/spm/src/drivers/laplacian.c	2021-01-10 11:58:33.000000000 +0100
+++ PaStiX4CalculiX-2.17_cudaless/spm/src/drivers/laplacian.c	2021-02-15 09:27:56.310302400 +0100
@@ -108,8 +108,9 @@
 
     /* Look for the datatype */
     {
-        char flt;
-        char *tmpf = strndup( filename, 256 );
+        size_t nfilename = strlen( filename );
+        char  flt, *tmpf;
+        tmpf = calloc( spm_imax( nfilename, 256 ), sizeof(char) );
 
         if ( sscanf( filename, "%c:%254s", &flt, tmpf ) == 2 ) {
             filename += 2;
